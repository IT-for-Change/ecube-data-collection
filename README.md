# KITE ECUBE ELL Data Collection Tool

### About

This is the KITE ECUBE English Language Lab (ELL) data collection tool. Read more about KITE [here](https://kite.kerala.gov.in) and the ECUBE ELL [here](https://ecube.kite.kerala.gov.in). If you are unfamiliar with the ELL software technology and its packaging, read [this wiki page](https://github.com/IT-for-Change/ecube-data-collection/wiki) first.

## Who is this tool intended for

This tool is intended for use by organizations that run the KITE ECUBE ELL software and interested in analyzing student engagement and performance data. Some technical proficiency is required to use the tool to 1) ensure the necessary prerequisites are met, and 2) actually execute the tool. The person running the tool should be able to understand the rest of the content in this README and able to execute the tasks mentioned.

## KITE OS vs. Docker vs. Ubuntu deployments of the ELL

The ELL can be deployed on a computer in different ways - computers can run the ELL on KITE OS, or as a docker container on any OS, or on plain Ubuntu OS. See [here](https://kite.kerala.gov.in/llabdownload.html) for details of supported OS versions. The data collection tool should work on all these flavours, but since the largest deployment of the tool so far is on [KITE OS](https://kite.kerala.gov.in/KITE/index.php/welcome/downloads), the tool is designed to assume a KITE OS deployment by default, and the tool's default configuration values correspond to KITE OS. 

This README too reflects the fact, and focuses on KITE OS deployments. If you are using a docker-based deployment, skip to the section here for instructions on pre-requisites and for customizing the tool's configuration values.

The tool should work correctly on plain Ubuntu OS deployments of the ELL if it is configured correctly. The tool has not been tested on a plain Ubuntu deployment.

## What data is collected by the tool?

* The ELL database, in the form of a mysqldump sql file
* Audio files (webm/ogg)

All of the collected data is packaged into a single tar.gz file.

## Prerequisites (KITE OS)

### 1. Software checks

If you are running the ELL on KITE OS, all software prerequisites should already be met. But please make the following checks to confirm this.

1. The presence of Python 3.8 (or higher version) on the system. Do this by opening a terminal window and executing the command:

```
python3
```

You should see output similar to:

```
Python 3.8.10 (default, Sep 28 2021, 16:10:42) 
[GCC 9.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

2. Confirm the ELL is installed under /opt/lampp. Run the command on a new terminal window.

```
ls /opt/lampp
```

You should see output similar to:

```
apache2  cgi-bin       e_cube          error   icons    info   lib64     logs                   manual      mysql  phpmyadmin      README.md     sbin   THIRDPARTY     var
bin      ctlscript.sh  ecube-files     etc     img      lampp  libexec   man                    modules     pear   proftpd         README-wsrep  share  uninstall      xampp
build    docs          e-cube_version  htdocs  include  lib    licenses  manager-linux-x64.run  moodledata  php    properties.ini  RELEASENOTES  temp   uninstall.dat
```

### 2. Configuration

1. The ELL uses a MySQL database. The tool connects to this database to download data. The configuration parameters to connect to the database are specified in the **collect.conf** file. The values reflect the ELL installation defaults on KITE OS. No action is required if you are running the tool on the default KITE OS setup of the ELL.
2. The tool assumes the ELL has been installed under the **/opt/lampp/** directory. If you are running ELL on KITE OS, this is the default installation location and no action is required to change anything.


### 3. Mandatory information required by the tool

#### School code
When you run the tool, it will prompt you to enter a **school code**. This code uniquely identifies your school and associates the collected data with the school. This information is mandatory for the tool to execute. Contact your IT administrator to obtain this information before executing the tool.

## Prerequisites (DOCKER)

TBD

## Are you ready to execute the tool?

1. Confirm all prerequisites are met
2. Confirm you have the school code on hand
3. Confirm you have the credentials to login to the computer on which the ELL is installed and have the permissions to start the ELL software there. 
4. Confirm you know where to upload the final data package (tar.gz) file that will be generated by the tool. If the ELL computer does not have access to the internet, you may need an USB stick on hand to copy the data package to another computer and upload it.

## Steps to execute the tool

The tool will need less than a minute to execute. Assuming all prerequisite checks have passed and you have the school code on hand, you should not need more than aside 30 minutes to perform the check for prerequisites, take necessary actions
1. Login to the computer on which the ECUBE ELL software is installed. The login user should have rights to start the software
2. Start the ELL as per the normal procedure documented by the ELL software and login as any user. This is to confirm the ELL database has started and is running. Proceed to the next step only if you are able to login successfully into the ELL
3. Download the latest release version of the tool to the computer on which the ELL is installed. The latest release of the tool is available [here](https://github.com/IT-for-Change/ecube-data-collection/releases) as a tar.gz file.
5. Move the downloaded file to your home directory. 
6. Extract the tar.gz file to any folder under the home directory
7. Open a terminal window and navigate to this directory. Once you are inside this directory, run the `ls` command, you should see the following output:

```
$ls
collect.conf  collect.py  LICENSE  README.md  run-collect.sh
```

8. Grant execute permission for the **run-collect.sh** script with the following command:

```
$chmod 777 run-collect.sh
```

9. Execute the tool by running the script

```
$./run-collect.sh
```

10. If the tool completes execution successfully, you should see the following as the last two lines of the execution log on the terminal window (the date time and the filename will vary, of course):

```
27/03/2023 08:08:07 AM - INFO: Data collection complete.
27/03/2023 08:08:07 AM - INFO: Upload the file 'dfdc1e57-f828-4789-8506-974e06ec6664.tar.gz' as instructed
```

11. Open the file explorer and navigate to the tool location under your home directory. The data package file (.tar.gz) will be available under the **uploads** directory.
12. Upload the file as instructured. **DO NOT** upload the 'upload' directory itself. Upload **ONLY** the .tar.gz file! **DO NOT** upload anything else from the tool directory. The .tar.gz file has everything that is needed!

## Troubleshooting

## Upload the data file
